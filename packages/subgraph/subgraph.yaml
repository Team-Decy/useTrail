specVersion: 0.0.4
description: A subgraph for Shipping data
repository: https://github.com/Team-Decy/useTrail
schema:
  file: ./src/schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Auth
    network: mainnet
    source:
      address: "0xAuthContractAddress"
      abi: Auth
      startBlock: 12345678
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - User
      abis:
        - name: Auth
          file: ./abis/Auth.json
        - name: RoleManagement
          file: ./abis/RoleManagement.json
      eventHandlers:
        - event: UserAuthorized(address)
          handler: handleUserAuthorized
      file: ./src/mapping.ts

  - kind: ethereum/contract
    name: RoleManagement
    network: mainnet
    source:
      address: "0xRoleManagementContractAddress"
      abi: RoleManagement
      startBlock: 12345678
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - User
      abis:
        - name: RoleManagement
          file: ./abis/RoleManagement.json
      eventHandlers:
        - event: RoleAssigned(address, string)
          handler: handleRoleAssigned
      file: ./src/mapping.ts

  - kind: ethereum/contract
    name: PaymentSystem
    network: mainnet
    source:
      address: "0xPaymentSystemContractAddress"
      abi: PaymentSystem
      startBlock: 12345678
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Payment
        - Shipment
        - User
      abis:
        - name: PaymentSystem
          file: ./abis/PaymentSystem.json
        - name: ShipmentTracking
          file: ./abis/ShipmentTracking.json
        - name: RoleManagement
          file: ./abis/RoleManagement.json
      eventHandlers:
        - event: PaymentMade(address , address, uint256, uint256)
          handler: handlePaymentMade
      file: ./src/mapping.ts

  - kind: ethereum/contract
    name: ShipmentTracking
    network: mainnet
    source:
      address: "0xShipmentTrackingContractAddress"
      abi: ShipmentTracking
      startBlock: 12345678
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Shipment
        - User
        - Payment
      abis:
        - name: ShipmentTracking
          file: ./abis/ShipmentTracking.json
        - name: RoleManagement
          file: ./abis/RoleManagement.json
        - name: PaymentSystem
          file: ./abis/PaymentSystem.json
      eventHandlers:
        - event: ShipmentCreated(uint256,string, string, address)
          handler: handleShipmentCreated
        - event: ShipmentUpdated(uint256,string, string, address)
          handler: handleShipmentUpdated  
      file: ./src/mapping.ts